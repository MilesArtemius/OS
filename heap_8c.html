<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MushOS: heap.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.svg"/></td>
  <td id="projectalign">
   <div id="projectname">MushOS<span id="projectnumber">&#160;0.1</span>
   </div>
   <div id="projectbrief">Only creating something you can understand completely how it should work</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('heap_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">heap.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="heap_8h_source.html">heap.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="memory_8h_source.html">memory.h</a>&quot;</code><br />
</div>
<p><a href="heap_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab87020fe29ea57655ea7399aec22d82f"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structheap__block__header.html">heap_block_header</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heap_8c.html#ab87020fe29ea57655ea7399aec22d82f">get_header</a> (void *structure)</td></tr>
<tr class="separator:ab87020fe29ea57655ea7399aec22d82f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1136a0be1b0cb0a20d43988acbbf868a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="generic_8h.html#a996480788fe7aade5c563eb2cad100fb">u_dword</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heap_8c.html#a1136a0be1b0cb0a20d43988acbbf868a">size</a> (void *structure)</td></tr>
<tr class="separator:a1136a0be1b0cb0a20d43988acbbf868a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6cef963b0fefbfc8338a51d7664eb6c"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heap_8c.html#ae6cef963b0fefbfc8338a51d7664eb6c">allocate_space</a> (void *free_pointer, <a class="el" href="generic_8h.html#a996480788fe7aade5c563eb2cad100fb">u_dword</a> <a class="el" href="heap_8c.html#a1136a0be1b0cb0a20d43988acbbf868a">size</a>, <a class="el" href="structheap__block__header.html">heap_block_header</a> *previous, <a class="el" href="structheap__block__header.html">heap_block_header</a> *next)</td></tr>
<tr class="separator:ae6cef963b0fefbfc8338a51d7664eb6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a817aef8c0f7d43cd36caffbb0f4116f1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heap_8c.html#a817aef8c0f7d43cd36caffbb0f4116f1">initialize_heap</a> (void *start_address, <a class="el" href="generic_8h.html#a996480788fe7aade5c563eb2cad100fb">u_dword</a> <a class="el" href="heap_8c.html#a1136a0be1b0cb0a20d43988acbbf868a">size</a>)</td></tr>
<tr class="separator:a817aef8c0f7d43cd36caffbb0f4116f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a419206ef0312511f4215a242239f1f44"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heap_8c.html#a419206ef0312511f4215a242239f1f44">malloc</a> (<a class="el" href="generic_8h.html#a996480788fe7aade5c563eb2cad100fb">u_dword</a> <a class="el" href="heap_8c.html#a1136a0be1b0cb0a20d43988acbbf868a">size</a>)</td></tr>
<tr class="separator:a419206ef0312511f4215a242239f1f44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a665f842bf4ffef22fe04c0bd031b63bb"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heap_8c.html#a665f842bf4ffef22fe04c0bd031b63bb">realloc</a> (void *structure, <a class="el" href="generic_8h.html#a996480788fe7aade5c563eb2cad100fb">u_dword</a> new_size)</td></tr>
<tr class="separator:a665f842bf4ffef22fe04c0bd031b63bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bb6f72fcf8470173f063f9d763eb2cc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heap_8c.html#a6bb6f72fcf8470173f063f9d763eb2cc">free</a> (void *structure)</td></tr>
<tr class="separator:a6bb6f72fcf8470173f063f9d763eb2cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ad25819039368a36136ac811954d5f901"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structheap__header.html">heap_header</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heap_8c.html#ad25819039368a36136ac811954d5f901">header</a></td></tr>
<tr class="separator:ad25819039368a36136ac811954d5f901"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ab87020fe29ea57655ea7399aec22d82f" name="ab87020fe29ea57655ea7399aec22d82f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab87020fe29ea57655ea7399aec22d82f">&#9670;&#160;</a></span>get_header()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="structheap__block__header.html">heap_block_header</a> * get_header </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>structure</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Internal function for getting heap header of any structure located in heap. It just substracts heap block header size from pointer and casts it to heap block header. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">structure</td><td>a pointer to the structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structheap__block__header.html">heap_block_header</a> pointer. </dd></dl>

<p class="definition">Definition at line <a class="el" href="heap_8c_source.html#l00028">28</a> of file <a class="el" href="heap_8c_source.html">heap.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   28</span>                                                      {</div>
<div class="line"><span class="lineno">   29</span>    <span class="keywordflow">return</span> (<a class="code hl_struct" href="structheap__block__header.html">heap_block_header</a>*) (structure - <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structheap__block__header.html">heap_block_header</a>));</div>
<div class="line"><span class="lineno">   30</span>}</div>
<div class="ttc" id="astructheap__block__header_html"><div class="ttname"><a href="structheap__block__header.html">heap_block_header</a></div><div class="ttdef"><b>Definition:</b> <a href="heap_8h_source.html#l00007">heap.h:7</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="heap_8c_source.html#l00054">allocate_space()</a>, <a class="el" href="heap_8c_source.html#l00163">free()</a>, <a class="el" href="heap_8c_source.html#l00089">malloc()</a>, <a class="el" href="heap_8c_source.html#l00143">realloc()</a>, and <a class="el" href="heap_8c_source.html#l00038">size()</a>.</p>

</div>
</div>
<a id="a1136a0be1b0cb0a20d43988acbbf868a" name="a1136a0be1b0cb0a20d43988acbbf868a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1136a0be1b0cb0a20d43988acbbf868a">&#9670;&#160;</a></span>size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="generic_8h.html#a996480788fe7aade5c563eb2cad100fb">u_dword</a> size </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>structure</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Function for structure located in heap size calculation (in bytes). Throws heap exception if the given pointer is outside of the current heap. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">structure</td><td>a pointer to the structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>structure size (in bytes). </dd></dl>

<p class="definition">Definition at line <a class="el" href="heap_8c_source.html#l00038">38</a> of file <a class="el" href="heap_8c_source.html">heap.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   38</span>                              {</div>
<div class="line"><span class="lineno">   39</span>    <span class="keywordflow">if</span> (structure &gt; <a class="code hl_variable" href="heap_8c.html#ad25819039368a36136ac811954d5f901">header</a>-&gt;<a class="code hl_variable" href="structheap__header.html#a9523e984a0a7dfc1b5ae419afe660a45">heap_start</a> &amp;&amp; structure &lt; header-&gt;heap_end) <span class="keywordflow">return</span> <a class="code hl_function" href="heap_8c.html#ab87020fe29ea57655ea7399aec22d82f">get_header</a>(structure)-&gt;<a class="code hl_variable" href="structheap__block__header.html#a1767768a029a27412964359d72ca2096">size</a>;</div>
<div class="line"><span class="lineno">   40</span>    else ; <span class="comment">// TODO: throw exception: requested structure is outside of the heap!</span></div>
<div class="line"><span class="lineno">   41</span>}</div>
<div class="ttc" id="aheap_8c_html_ab87020fe29ea57655ea7399aec22d82f"><div class="ttname"><a href="heap_8c.html#ab87020fe29ea57655ea7399aec22d82f">get_header</a></div><div class="ttdeci">static heap_block_header * get_header(void *structure)</div><div class="ttdef"><b>Definition:</b> <a href="heap_8c_source.html#l00028">heap.c:28</a></div></div>
<div class="ttc" id="aheap_8c_html_ad25819039368a36136ac811954d5f901"><div class="ttname"><a href="heap_8c.html#ad25819039368a36136ac811954d5f901">header</a></div><div class="ttdeci">heap_header * header</div><div class="ttdef"><b>Definition:</b> <a href="heap_8c_source.html#l00018">heap.c:18</a></div></div>
<div class="ttc" id="astructheap__block__header_html_a1767768a029a27412964359d72ca2096"><div class="ttname"><a href="structheap__block__header.html#a1767768a029a27412964359d72ca2096">heap_block_header::size</a></div><div class="ttdeci">u_dword size</div><div class="ttdef"><b>Definition:</b> <a href="heap_8h_source.html#l00008">heap.h:8</a></div></div>
<div class="ttc" id="astructheap__header_html_a9523e984a0a7dfc1b5ae419afe660a45"><div class="ttname"><a href="structheap__header.html#a9523e984a0a7dfc1b5ae419afe660a45">heap_header::heap_start</a></div><div class="ttdeci">void * heap_start</div><div class="ttdef"><b>Definition:</b> <a href="heap_8h_source.html#l00014">heap.h:14</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="heap_8c_source.html#l00028">get_header()</a>, <a class="el" href="heap_8c_source.html#l00018">header</a>, <a class="el" href="heap_8h_source.html#l00014">heap_header::heap_start</a>, and <a class="el" href="heap_8h_source.html#l00008">heap_block_header::size</a>.</p>

<p class="reference">Referenced by <a class="el" href="heap_8c_source.html#l00054">allocate_space()</a>, <a class="el" href="string_8c_source.html#l00010">copy_part()</a>, <a class="el" href="heap_8c_source.html#l00074">initialize_heap()</a>, <a class="el" href="heap_8c_source.html#l00089">malloc()</a>, and <a class="el" href="heap_8c_source.html#l00143">realloc()</a>.</p>

</div>
</div>
<a id="ae6cef963b0fefbfc8338a51d7664eb6c" name="ae6cef963b0fefbfc8338a51d7664eb6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6cef963b0fefbfc8338a51d7664eb6c">&#9670;&#160;</a></span>allocate_space()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void * allocate_space </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>free_pointer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="generic_8h.html#a996480788fe7aade5c563eb2cad100fb">u_dword</a>&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structheap__block__header.html">heap_block_header</a> *&#160;</td>
          <td class="paramname"><em>previous</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structheap__block__header.html">heap_block_header</a> *&#160;</td>
          <td class="paramname"><em>next</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Internal function for space allocation in heap. Sets up and fills heap block header, optionally alters headers of the next and previous heap blocks. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">free_pointer</td><td>pointer to free space (heap block header size + required size). </td></tr>
    <tr><td class="paramname">size</td><td>required size of heap block. </td></tr>
    <tr><td class="paramname">previous</td><td>previous heap block. </td></tr>
    <tr><td class="paramname">next</td><td>next heap block. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to the start of the block. </dd></dl>

<p class="definition">Definition at line <a class="el" href="heap_8c_source.html#l00054">54</a> of file <a class="el" href="heap_8c_source.html">heap.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   54</span>                                                                                                                    {</div>
<div class="line"><span class="lineno">   55</span>    ((<a class="code hl_struct" href="structheap__block__header.html">heap_block_header</a>*) free_pointer)-&gt;size = <a class="code hl_function" href="heap_8c.html#a1136a0be1b0cb0a20d43988acbbf868a">size</a>;</div>
<div class="line"><span class="lineno">   56</span>    ((<a class="code hl_struct" href="structheap__block__header.html">heap_block_header</a>*) free_pointer)-&gt;previous = previous;</div>
<div class="line"><span class="lineno">   57</span>    ((<a class="code hl_struct" href="structheap__block__header.html">heap_block_header</a>*) free_pointer)-&gt;<a class="code hl_variable" href="structheap__block__header.html#ac4951d447778c02b47fdeded1a6b859d">next</a> = next;</div>
<div class="line"><span class="lineno">   58</span> </div>
<div class="line"><span class="lineno">   59</span>    <span class="keywordtype">void</span>* memory_address = free_pointer + <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structheap__block__header.html">heap_block_header</a>);</div>
<div class="line"><span class="lineno">   60</span>    <span class="keywordflow">if</span> (previous) <a class="code hl_function" href="heap_8c.html#ab87020fe29ea57655ea7399aec22d82f">get_header</a>(previous)-&gt;<a class="code hl_variable" href="structheap__block__header.html#ac4951d447778c02b47fdeded1a6b859d">next</a> = memory_address;</div>
<div class="line"><span class="lineno">   61</span>    <span class="keywordflow">if</span> (next) <a class="code hl_function" href="heap_8c.html#ab87020fe29ea57655ea7399aec22d82f">get_header</a>(next)-&gt;<a class="code hl_variable" href="structheap__block__header.html#aa5184d88d245d2014f0b0950b65b55c2">previous</a> = memory_address;</div>
<div class="line"><span class="lineno">   62</span>    <span class="keywordflow">return</span> memory_address;</div>
<div class="line"><span class="lineno">   63</span>}</div>
<div class="ttc" id="aheap_8c_html_a1136a0be1b0cb0a20d43988acbbf868a"><div class="ttname"><a href="heap_8c.html#a1136a0be1b0cb0a20d43988acbbf868a">size</a></div><div class="ttdeci">u_dword size(void *structure)</div><div class="ttdef"><b>Definition:</b> <a href="heap_8c_source.html#l00038">heap.c:38</a></div></div>
<div class="ttc" id="astructheap__block__header_html_aa5184d88d245d2014f0b0950b65b55c2"><div class="ttname"><a href="structheap__block__header.html#aa5184d88d245d2014f0b0950b65b55c2">heap_block_header::previous</a></div><div class="ttdeci">void * previous</div><div class="ttdef"><b>Definition:</b> <a href="heap_8h_source.html#l00009">heap.h:9</a></div></div>
<div class="ttc" id="astructheap__block__header_html_ac4951d447778c02b47fdeded1a6b859d"><div class="ttname"><a href="structheap__block__header.html#ac4951d447778c02b47fdeded1a6b859d">heap_block_header::next</a></div><div class="ttdeci">void * next</div><div class="ttdef"><b>Definition:</b> <a href="heap_8h_source.html#l00009">heap.h:9</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="heap_8c_source.html#l00028">get_header()</a>, <a class="el" href="heap_8h_source.html#l00009">heap_block_header::next</a>, <a class="el" href="heap_8h_source.html#l00009">heap_block_header::previous</a>, and <a class="el" href="heap_8c_source.html#l00038">size()</a>.</p>

<p class="reference">Referenced by <a class="el" href="heap_8c_source.html#l00089">malloc()</a>.</p>

</div>
</div>
<a id="a817aef8c0f7d43cd36caffbb0f4116f1" name="a817aef8c0f7d43cd36caffbb0f4116f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a817aef8c0f7d43cd36caffbb0f4116f1">&#9670;&#160;</a></span>initialize_heap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initialize_heap </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>start_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="generic_8h.html#a996480788fe7aade5c563eb2cad100fb">u_dword</a>&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Function for heap initialization, sets up singleton heap header. This implementation of heap has fixed size, and so doesn't rely on paging. That's enough for kernel and basic app needs, TODO: provide another heap implementation for extended MushLib. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">start_address</td><td>pointer to the start of the heap. </td></tr>
    <tr><td class="paramname">size</td><td>size of the heap. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="heap_8c_source.html#l00074">74</a> of file <a class="el" href="heap_8c_source.html">heap.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   74</span>                                                        {</div>
<div class="line"><span class="lineno">   75</span>    <a class="code hl_variable" href="heap_8c.html#ad25819039368a36136ac811954d5f901">header</a> = start_address;</div>
<div class="line"><span class="lineno">   76</span>    <a class="code hl_function" href="memory_8c.html#a7c557b33bace79ab51a9fd7439de7202">memory_clear</a>(start_address, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structheap__header.html">heap_header</a>), 0);</div>
<div class="line"><span class="lineno">   77</span>    <a class="code hl_variable" href="heap_8c.html#ad25819039368a36136ac811954d5f901">header</a>-&gt;<a class="code hl_variable" href="structheap__header.html#a9523e984a0a7dfc1b5ae419afe660a45">heap_start</a> = start_address + <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structheap__header.html">heap_header</a>);</div>
<div class="line"><span class="lineno">   78</span>    <a class="code hl_variable" href="heap_8c.html#ad25819039368a36136ac811954d5f901">header</a>-&gt;<a class="code hl_variable" href="structheap__header.html#a5f4d63eee711fe950c4a3fd4e2ace28a">heap_end</a> = start_address + <a class="code hl_function" href="heap_8c.html#a1136a0be1b0cb0a20d43988acbbf868a">size</a>;</div>
<div class="line"><span class="lineno">   79</span>    <a class="code hl_variable" href="heap_8c.html#ad25819039368a36136ac811954d5f901">header</a>-&gt;<a class="code hl_variable" href="structheap__header.html#a511fa2a21a1fb0fc978ac0a70526215b">first_address</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">   80</span>}</div>
<div class="ttc" id="amemory_8c_html_a7c557b33bace79ab51a9fd7439de7202"><div class="ttname"><a href="memory_8c.html#a7c557b33bace79ab51a9fd7439de7202">memory_clear</a></div><div class="ttdeci">void memory_clear(byte *start, u_dword num_bytes, byte sample)</div><div class="ttdef"><b>Definition:</b> <a href="memory_8c_source.html#l00010">memory.c:10</a></div></div>
<div class="ttc" id="astructheap__header_html"><div class="ttname"><a href="structheap__header.html">heap_header</a></div><div class="ttdef"><b>Definition:</b> <a href="heap_8h_source.html#l00012">heap.h:12</a></div></div>
<div class="ttc" id="astructheap__header_html_a511fa2a21a1fb0fc978ac0a70526215b"><div class="ttname"><a href="structheap__header.html#a511fa2a21a1fb0fc978ac0a70526215b">heap_header::first_address</a></div><div class="ttdeci">void * first_address</div><div class="ttdef"><b>Definition:</b> <a href="heap_8h_source.html#l00013">heap.h:13</a></div></div>
<div class="ttc" id="astructheap__header_html_a5f4d63eee711fe950c4a3fd4e2ace28a"><div class="ttname"><a href="structheap__header.html#a5f4d63eee711fe950c4a3fd4e2ace28a">heap_header::heap_end</a></div><div class="ttdeci">void * heap_end</div><div class="ttdef"><b>Definition:</b> <a href="heap_8h_source.html#l00014">heap.h:14</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="heap_8h_source.html#l00013">heap_header::first_address</a>, <a class="el" href="heap_8c_source.html#l00018">header</a>, <a class="el" href="heap_8h_source.html#l00014">heap_header::heap_end</a>, <a class="el" href="heap_8h_source.html#l00014">heap_header::heap_start</a>, <a class="el" href="memory_8c_source.html#l00010">memory_clear()</a>, and <a class="el" href="heap_8c_source.html#l00038">size()</a>.</p>

<p class="reference">Referenced by <a class="el" href="kernel_8c_source.html#l00041">_start()</a>.</p>

</div>
</div>
<a id="a419206ef0312511f4215a242239f1f44" name="a419206ef0312511f4215a242239f1f44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a419206ef0312511f4215a242239f1f44">&#9670;&#160;</a></span>malloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * malloc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="generic_8h.html#a996480788fe7aade5c563eb2cad100fb">u_dword</a>&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Function for allocation of a heap block. Searches for a place of suitable size to fit a structure of requested size in. Throws heap exception if no free space is available. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>requested block size. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to the neewly allocated block. </dd></dl>

<p class="definition">Definition at line <a class="el" href="heap_8c_source.html#l00089">89</a> of file <a class="el" href="heap_8c_source.html">heap.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   89</span>                           {</div>
<div class="line"><span class="lineno">   90</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="heap_8c.html#ad25819039368a36136ac811954d5f901">header</a>-&gt;<a class="code hl_variable" href="structheap__header.html#a511fa2a21a1fb0fc978ac0a70526215b">first_address</a>) {</div>
<div class="line"><span class="lineno">   91</span>        <span class="keywordtype">void</span>* best_address = <span class="keyword">nullptr</span>, * best_previous = <span class="keyword">nullptr</span>, * best_next = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">   92</span>        <a class="code hl_typedef" href="generic_8h.html#a996480788fe7aade5c563eb2cad100fb">u_dword</a> best_size = <a class="code hl_variable" href="heap_8c.html#ad25819039368a36136ac811954d5f901">header</a>-&gt;<a class="code hl_variable" href="structheap__header.html#a5f4d63eee711fe950c4a3fd4e2ace28a">heap_end</a> - <a class="code hl_variable" href="heap_8c.html#ad25819039368a36136ac811954d5f901">header</a>-&gt;<a class="code hl_variable" href="structheap__header.html#a9523e984a0a7dfc1b5ae419afe660a45">heap_start</a>;</div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span>        <span class="keywordtype">void</span>* current_address = <a class="code hl_variable" href="heap_8c.html#ad25819039368a36136ac811954d5f901">header</a>-&gt;<a class="code hl_variable" href="structheap__header.html#a9523e984a0a7dfc1b5ae419afe660a45">heap_start</a>;</div>
<div class="line"><span class="lineno">   95</span>        <span class="keywordtype">void</span>* next_address = <a class="code hl_variable" href="heap_8c.html#ad25819039368a36136ac811954d5f901">header</a>-&gt;<a class="code hl_variable" href="structheap__header.html#a511fa2a21a1fb0fc978ac0a70526215b">first_address</a>;</div>
<div class="line"><span class="lineno">   96</span> </div>
<div class="line"><span class="lineno">   97</span>        <a class="code hl_typedef" href="generic_8h.html#a996480788fe7aade5c563eb2cad100fb">u_dword</a> free_space_size = next_address - current_address - <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structheap__block__header.html">heap_block_header</a>);</div>
<div class="line"><span class="lineno">   98</span>        <span class="keywordflow">if</span> ((free_space_size &gt;= (<a class="code hl_function" href="heap_8c.html#a1136a0be1b0cb0a20d43988acbbf868a">size</a> + <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structheap__block__header.html">heap_block_header</a>))) &amp;&amp; (free_space_size &lt; best_size)) {</div>
<div class="line"><span class="lineno">   99</span>            best_size = free_space_size;</div>
<div class="line"><span class="lineno">  100</span>            best_address = current_address; best_previous = <span class="keyword">nullptr</span>; best_next = next_address;</div>
<div class="line"><span class="lineno">  101</span>        }</div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span>        current_address = next_address;</div>
<div class="line"><span class="lineno">  104</span>        <a class="code hl_struct" href="structheap__block__header.html">heap_block_header</a>* current_block = <a class="code hl_function" href="heap_8c.html#ab87020fe29ea57655ea7399aec22d82f">get_header</a>(current_address);</div>
<div class="line"><span class="lineno">  105</span>        next_address = current_block-&gt;<a class="code hl_variable" href="structheap__block__header.html#ac4951d447778c02b47fdeded1a6b859d">next</a>;</div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span>        <span class="keywordflow">while</span> (next_address) {</div>
<div class="line"><span class="lineno">  108</span>            free_space_size = next_address - current_address - current_block-&gt;<a class="code hl_variable" href="structheap__block__header.html#a1767768a029a27412964359d72ca2096">size</a> - <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structheap__block__header.html">heap_block_header</a>);</div>
<div class="line"><span class="lineno">  109</span>            <span class="keywordflow">if</span> ((free_space_size &gt;= (<a class="code hl_function" href="heap_8c.html#a1136a0be1b0cb0a20d43988acbbf868a">size</a> + <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structheap__block__header.html">heap_block_header</a>))) &amp;&amp; (free_space_size &lt; best_size)) {</div>
<div class="line"><span class="lineno">  110</span>                best_size = free_space_size;</div>
<div class="line"><span class="lineno">  111</span>                best_address = current_address + current_block-&gt;<a class="code hl_variable" href="structheap__block__header.html#a1767768a029a27412964359d72ca2096">size</a>; best_previous = current_address; best_next = next_address;</div>
<div class="line"><span class="lineno">  112</span>            }</div>
<div class="line"><span class="lineno">  113</span> </div>
<div class="line"><span class="lineno">  114</span>            current_address = next_address;</div>
<div class="line"><span class="lineno">  115</span>            current_block = <a class="code hl_function" href="heap_8c.html#ab87020fe29ea57655ea7399aec22d82f">get_header</a>(current_address);</div>
<div class="line"><span class="lineno">  116</span>            next_address = current_block-&gt;<a class="code hl_variable" href="structheap__block__header.html#ac4951d447778c02b47fdeded1a6b859d">next</a>;</div>
<div class="line"><span class="lineno">  117</span>        }</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span>        free_space_size = <a class="code hl_variable" href="heap_8c.html#ad25819039368a36136ac811954d5f901">header</a>-&gt;<a class="code hl_variable" href="structheap__header.html#a5f4d63eee711fe950c4a3fd4e2ace28a">heap_end</a> - current_address - current_block-&gt;<a class="code hl_variable" href="structheap__block__header.html#a1767768a029a27412964359d72ca2096">size</a> - <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structheap__block__header.html">heap_block_header</a>);</div>
<div class="line"><span class="lineno">  120</span>        <span class="keywordflow">if</span> ((free_space_size &gt;= (<a class="code hl_function" href="heap_8c.html#a1136a0be1b0cb0a20d43988acbbf868a">size</a> + <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structheap__block__header.html">heap_block_header</a>))) &amp;&amp; (free_space_size &lt; best_size)) {</div>
<div class="line"><span class="lineno">  121</span>            best_address = current_address + current_block-&gt;<a class="code hl_variable" href="structheap__block__header.html#a1767768a029a27412964359d72ca2096">size</a>; best_previous = current_address; best_next = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  122</span>        }</div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span>        <span class="keywordtype">void</span>* final_address = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  125</span>        <span class="keywordflow">if</span> (best_address != <span class="keyword">nullptr</span>) final_address = <a class="code hl_function" href="heap_8c.html#ae6cef963b0fefbfc8338a51d7664eb6c">allocate_space</a>(best_address, <a class="code hl_function" href="heap_8c.html#a1136a0be1b0cb0a20d43988acbbf868a">size</a>, best_previous, best_next);</div>
<div class="line"><span class="lineno">  126</span>        <span class="keywordflow">if</span> (best_address == <a class="code hl_variable" href="heap_8c.html#ad25819039368a36136ac811954d5f901">header</a>-&gt;<a class="code hl_variable" href="structheap__header.html#a9523e984a0a7dfc1b5ae419afe660a45">heap_start</a>) <a class="code hl_variable" href="heap_8c.html#ad25819039368a36136ac811954d5f901">header</a>-&gt;<a class="code hl_variable" href="structheap__header.html#a511fa2a21a1fb0fc978ac0a70526215b">first_address</a> = final_address;</div>
<div class="line"><span class="lineno">  127</span>        <span class="keywordflow">if</span> (final_address == <span class="keyword">nullptr</span>) ; <span class="comment">// TODO: Throw allocation exception, exception handling in kernel -&gt; panic.</span></div>
<div class="line"><span class="lineno">  128</span>        <span class="keywordflow">return</span> final_address;</div>
<div class="line"><span class="lineno">  129</span> </div>
<div class="line"><span class="lineno">  130</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  131</span>        <a class="code hl_variable" href="heap_8c.html#ad25819039368a36136ac811954d5f901">header</a>-&gt;<a class="code hl_variable" href="structheap__header.html#a511fa2a21a1fb0fc978ac0a70526215b">first_address</a> = <a class="code hl_function" href="heap_8c.html#ae6cef963b0fefbfc8338a51d7664eb6c">allocate_space</a>(<a class="code hl_variable" href="heap_8c.html#ad25819039368a36136ac811954d5f901">header</a>-&gt;<a class="code hl_variable" href="structheap__header.html#a9523e984a0a7dfc1b5ae419afe660a45">heap_start</a>, <a class="code hl_function" href="heap_8c.html#a1136a0be1b0cb0a20d43988acbbf868a">size</a>, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  132</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="heap_8c.html#ad25819039368a36136ac811954d5f901">header</a>-&gt;<a class="code hl_variable" href="structheap__header.html#a511fa2a21a1fb0fc978ac0a70526215b">first_address</a>;</div>
<div class="line"><span class="lineno">  133</span>    }</div>
<div class="line"><span class="lineno">  134</span>}</div>
<div class="ttc" id="ageneric_8h_html_a996480788fe7aade5c563eb2cad100fb"><div class="ttname"><a href="generic_8h.html#a996480788fe7aade5c563eb2cad100fb">u_dword</a></div><div class="ttdeci">unsigned int u_dword</div><div class="ttdef"><b>Definition:</b> <a href="generic_8h_source.html#l00008">generic.h:8</a></div></div>
<div class="ttc" id="aheap_8c_html_ae6cef963b0fefbfc8338a51d7664eb6c"><div class="ttname"><a href="heap_8c.html#ae6cef963b0fefbfc8338a51d7664eb6c">allocate_space</a></div><div class="ttdeci">static void * allocate_space(void *free_pointer, u_dword size, heap_block_header *previous, heap_block_header *next)</div><div class="ttdef"><b>Definition:</b> <a href="heap_8c_source.html#l00054">heap.c:54</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="heap_8c_source.html#l00054">allocate_space()</a>, <a class="el" href="heap_8h_source.html#l00013">heap_header::first_address</a>, <a class="el" href="heap_8c_source.html#l00028">get_header()</a>, <a class="el" href="heap_8c_source.html#l00018">header</a>, <a class="el" href="heap_8h_source.html#l00014">heap_header::heap_end</a>, <a class="el" href="heap_8h_source.html#l00014">heap_header::heap_start</a>, <a class="el" href="heap_8h_source.html#l00009">heap_block_header::next</a>, <a class="el" href="heap_8c_source.html#l00038">size()</a>, and <a class="el" href="heap_8h_source.html#l00008">heap_block_header::size</a>.</p>

<p class="reference">Referenced by <a class="el" href="vararg_8c_source.html#l00004">get_args()</a>, <a class="el" href="stdio_8c_source.html#l00102">print_colored()</a>, and <a class="el" href="heap_8c_source.html#l00143">realloc()</a>.</p>

</div>
</div>
<a id="a665f842bf4ffef22fe04c0bd031b63bb" name="a665f842bf4ffef22fe04c0bd031b63bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a665f842bf4ffef22fe04c0bd031b63bb">&#9670;&#160;</a></span>realloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * realloc </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>structure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="generic_8h.html#a996480788fe7aade5c563eb2cad100fb">u_dword</a>&#160;</td>
          <td class="paramname"><em>new_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Function for heap block size alteration. Attempts to alter size in-place and copys the block only if in-place growth is not available. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">structure</td><td>pointer to the structure for reallocation. </td></tr>
    <tr><td class="paramname">new_size</td><td>new requested size of the structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to the new structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="heap_8c_source.html#l00143">143</a> of file <a class="el" href="heap_8c_source.html">heap.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  143</span>                                                 {</div>
<div class="line"><span class="lineno">  144</span>    <a class="code hl_struct" href="structheap__block__header.html">heap_block_header</a>* block = <a class="code hl_function" href="heap_8c.html#ab87020fe29ea57655ea7399aec22d82f">get_header</a>(structure);</div>
<div class="line"><span class="lineno">  145</span>    <span class="keywordflow">if</span> (new_size &lt; block-&gt;<a class="code hl_function" href="heap_8c.html#a1136a0be1b0cb0a20d43988acbbf868a">size</a>) {</div>
<div class="line"><span class="lineno">  146</span>        block-&gt;<a class="code hl_variable" href="structheap__block__header.html#a1767768a029a27412964359d72ca2096">size</a> = new_size;</div>
<div class="line"><span class="lineno">  147</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (new_size &gt; block-&gt;<a class="code hl_variable" href="structheap__block__header.html#a1767768a029a27412964359d72ca2096">size</a>) {</div>
<div class="line"><span class="lineno">  148</span>        <span class="keywordflow">if</span> (new_size &lt; block-&gt;next - structure) block-&gt;<a class="code hl_variable" href="structheap__block__header.html#a1767768a029a27412964359d72ca2096">size</a> = new_size;</div>
<div class="line"><span class="lineno">  149</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  150</span>            <span class="keywordtype">void</span>* new_structure = <a class="code hl_function" href="heap_8c.html#a419206ef0312511f4215a242239f1f44">malloc</a>(new_size);</div>
<div class="line"><span class="lineno">  151</span>            <a class="code hl_function" href="memory_8c.html#aa8d072dd637d74351c52c4e8106d2552">memory_copy</a>(structure, new_structure, block-&gt;<a class="code hl_variable" href="structheap__block__header.html#a1767768a029a27412964359d72ca2096">size</a>);</div>
<div class="line"><span class="lineno">  152</span>            <a class="code hl_function" href="heap_8c.html#a6bb6f72fcf8470173f063f9d763eb2cc">free</a>(structure);</div>
<div class="line"><span class="lineno">  153</span>            structure = new_structure;</div>
<div class="line"><span class="lineno">  154</span>        }</div>
<div class="line"><span class="lineno">  155</span>    }</div>
<div class="line"><span class="lineno">  156</span>    <span class="keywordflow">return</span> structure;</div>
<div class="line"><span class="lineno">  157</span>}</div>
<div class="ttc" id="aheap_8c_html_a419206ef0312511f4215a242239f1f44"><div class="ttname"><a href="heap_8c.html#a419206ef0312511f4215a242239f1f44">malloc</a></div><div class="ttdeci">void * malloc(u_dword size)</div><div class="ttdef"><b>Definition:</b> <a href="heap_8c_source.html#l00089">heap.c:89</a></div></div>
<div class="ttc" id="aheap_8c_html_a6bb6f72fcf8470173f063f9d763eb2cc"><div class="ttname"><a href="heap_8c.html#a6bb6f72fcf8470173f063f9d763eb2cc">free</a></div><div class="ttdeci">void free(void *structure)</div><div class="ttdef"><b>Definition:</b> <a href="heap_8c_source.html#l00163">heap.c:163</a></div></div>
<div class="ttc" id="amemory_8c_html_aa8d072dd637d74351c52c4e8106d2552"><div class="ttname"><a href="memory_8c.html#aa8d072dd637d74351c52c4e8106d2552">memory_copy</a></div><div class="ttdeci">void memory_copy(byte *source, byte *dest, u_dword num_bytes)</div><div class="ttdef"><b>Definition:</b> <a href="memory_8c_source.html#l00004">memory.c:4</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="heap_8c_source.html#l00163">free()</a>, <a class="el" href="heap_8c_source.html#l00028">get_header()</a>, <a class="el" href="heap_8c_source.html#l00089">malloc()</a>, <a class="el" href="memory_8c_source.html#l00004">memory_copy()</a>, <a class="el" href="heap_8c_source.html#l00038">size()</a>, and <a class="el" href="heap_8h_source.html#l00008">heap_block_header::size</a>.</p>

</div>
</div>
<a id="a6bb6f72fcf8470173f063f9d763eb2cc" name="a6bb6f72fcf8470173f063f9d763eb2cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bb6f72fcf8470173f063f9d763eb2cc">&#9670;&#160;</a></span>free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void free </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>structure</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Function for heap block freeing. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">structure</td><td>pointer to the structure for freeing. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="heap_8c_source.html#l00163">163</a> of file <a class="el" href="heap_8c_source.html">heap.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  163</span>                           {</div>
<div class="line"><span class="lineno">  164</span>    <a class="code hl_struct" href="structheap__block__header.html">heap_block_header</a>* block = <a class="code hl_function" href="heap_8c.html#ab87020fe29ea57655ea7399aec22d82f">get_header</a>(structure);</div>
<div class="line"><span class="lineno">  165</span>    <span class="keywordflow">if</span> (structure == <a class="code hl_variable" href="heap_8c.html#ad25819039368a36136ac811954d5f901">header</a>-&gt;<a class="code hl_variable" href="structheap__header.html#a511fa2a21a1fb0fc978ac0a70526215b">first_address</a>) <a class="code hl_variable" href="heap_8c.html#ad25819039368a36136ac811954d5f901">header</a>-&gt;<a class="code hl_variable" href="structheap__header.html#a511fa2a21a1fb0fc978ac0a70526215b">first_address</a> = block-&gt;<a class="code hl_variable" href="structheap__block__header.html#ac4951d447778c02b47fdeded1a6b859d">next</a>;</div>
<div class="line"><span class="lineno">  166</span>    <span class="keywordflow">if</span> (block-&gt;<a class="code hl_variable" href="structheap__block__header.html#ac4951d447778c02b47fdeded1a6b859d">next</a>) <a class="code hl_function" href="heap_8c.html#ab87020fe29ea57655ea7399aec22d82f">get_header</a>(block-&gt;<a class="code hl_variable" href="structheap__block__header.html#ac4951d447778c02b47fdeded1a6b859d">next</a>)-&gt;<a class="code hl_variable" href="structheap__block__header.html#aa5184d88d245d2014f0b0950b65b55c2">previous</a> = block-&gt;<a class="code hl_variable" href="structheap__block__header.html#aa5184d88d245d2014f0b0950b65b55c2">previous</a>;</div>
<div class="line"><span class="lineno">  167</span>    <span class="keywordflow">if</span> (block-&gt;<a class="code hl_variable" href="structheap__block__header.html#aa5184d88d245d2014f0b0950b65b55c2">previous</a>) <a class="code hl_function" href="heap_8c.html#ab87020fe29ea57655ea7399aec22d82f">get_header</a>(block-&gt;<a class="code hl_variable" href="structheap__block__header.html#aa5184d88d245d2014f0b0950b65b55c2">previous</a>)-&gt;<a class="code hl_variable" href="structheap__block__header.html#ac4951d447778c02b47fdeded1a6b859d">next</a> = block-&gt;<a class="code hl_variable" href="structheap__block__header.html#ac4951d447778c02b47fdeded1a6b859d">next</a>;</div>
<div class="line"><span class="lineno">  168</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="heap_8h_source.html#l00013">heap_header::first_address</a>, <a class="el" href="heap_8c_source.html#l00028">get_header()</a>, <a class="el" href="heap_8c_source.html#l00018">header</a>, <a class="el" href="heap_8h_source.html#l00009">heap_block_header::next</a>, and <a class="el" href="heap_8h_source.html#l00009">heap_block_header::previous</a>.</p>

<p class="reference">Referenced by <a class="el" href="stdio_8c_source.html#l00102">print_colored()</a>, and <a class="el" href="heap_8c_source.html#l00143">realloc()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ad25819039368a36136ac811954d5f901" name="ad25819039368a36136ac811954d5f901"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad25819039368a36136ac811954d5f901">&#9670;&#160;</a></span>header</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structheap__header.html">heap_header</a>* header</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Header of the current app heap. Every app in MushOS has its own heap. This implementation of heap is a singleton. </p>

<p class="definition">Definition at line <a class="el" href="heap_8c_source.html#l00018">18</a> of file <a class="el" href="heap_8c_source.html">heap.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="heap_8c_source.html#l00163">free()</a>, <a class="el" href="heap_8c_source.html#l00074">initialize_heap()</a>, <a class="el" href="heap_8c_source.html#l00089">malloc()</a>, and <a class="el" href="heap_8c_source.html#l00038">size()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_d6f19446fd66376dca27abb0122f13dd.html">base</a></li><li class="navelem"><a class="el" href="heap_8c.html">heap.c</a></li>
    <li class="footer">Generated on Sun Jan 8 2023 21:26:35 for MushOS by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
